<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>B1G Geoportal</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/b1g.css">
    <link rel="stylesheet" href="css/font-awesome/css/font-awesome.min.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section data-background="img/aerial_photo.png">
          <h1 class="project-tagline">
            B1G Geoportal
          </h1>
          <div class="project-text">
            <h3>Development Update</h3>
            <p>December 2017 Summit</p>
            <p>
              <small>
                <a href="mailto:ewlarson@umn.edu">
                  <i class="fa  fa-envelope">
                  </i> Eric Larson</a>
                &nbsp; / &nbsp;
                <a href="http://twitter.com/ewlarson_umn">
                  <i class="fa fa-twitter"></i>
                  @ewlarson_umn
                </a>
              </small>
            </p>
          </div>
        </section>

        <section>
          <section>
            <h2>Hello!</h2>
            <p>It's super nice to be here.</p>
          </section>

          <section>
            <h2>
              <i class="fa icon-warning-sign"></i>
              Warning!
            </h2>
            <a href="http://www.html5rocks.com/en/">
              <img src="img/web_standards.png" alt="Web Standards: HTML5, CCS3, JS"/>
            </a>
          </section>
        </section>

        <section data-background="#2F3440">
          <section>
            <h2><i class="fa fa-arrow-circle-down"></i> My Background</h2>
          </section>

          <section>
            <img src="img/library_pic_iowa.png" alt="Picture of a library."/>
          </section>

          <section>
            <h2>
              UI &middot; Reshelving &middot; 1996-1998
            </h2>
            <a href="https://www.google.com/maps/place/University+of+Iowa+Libraries:+Main+Library/@41.659491,-91.5405977,17z/data=!3m2!4b1!5s0x87e441ed6d516dd7:0x9f907aad4f34cb70!4m5!3m4!1s0x87e441f50706c8c7:0x6601f5cb0fd7cd70!8m2!3d41.659491!4d-91.538409">
              <img src="img/library_map_iowa.png" alt="U of Iowa - Main Library"/>
            </a>
          </section>

          <section>
            <img src="img/library_pic_illinois.png" alt="Picture of a library."/>
          </section>

          <section>
            <h2>
              U of I &middot; BibApp &middot; 2006-2010
            </h2>
            <a href="https://www.google.com/maps/place/Grainger+Engineering+Library+Information+Center/@40.1124997,-88.2291059,17z/data=!3m2!4b1!5s0x880cd7401f15d3af:0xcf6a0239f89ae790!4m5!3m4!1s0x880cd76a968358b5:0xae7c7d5e32439ec2!8m2!3d40.1124997!4d-88.2269172">
              <img src="img/library_map_illinois.png" alt="U of Illinois - Grainger Engineering Library"/>
            </a>
          </section>

          <section>
            <h2>
              BibApp
            </h2>
            <a href="https://github.com/BibApp/BibApp">
              <img src="img/bibapp_01.png" alt="BibApp">
            </a>
          </section>

          <section>
            <h2 style="text-align:left;">BibApp</h2>
            <ul style="float:right; width:58%;">
              <li>UW Online Bibliography
              <li>Colophon
                <ul>
                  <li>Ruby on Rails</li>
                  <li>Apache Solr</li>
                </ul>
              </li>
            </ul>
            <img style="float:left" height="580" src="img/bibapp.png" alt="UW Forward"/>
          </section>

          <section>
            <img src="img/library_pic_wisc.png" alt="Picture of a library."/>
          </section>

          <section>
            <h2>
              UW &middot; Web Dev &middot; 2006-2013
            </h2>
            <a href="https://www.google.com/maps/place/Memorial+Library/@43.075434,-89.4000557,17z/data=!3m1!4b1!4m5!3m4!1s0x880653354a9961eb:0xe90183386a7a0193!8m2!3d43.075434!4d-89.397867">
              <img src="img/library_map_wisc.png" alt="UW - Memorial Library"/>
            </a>
          </section>

          <section>
            <h2 style="text-align:left;">
              <i class="fa fa-laptop"></i>
              UW Forward
            </h2>
            <a href="http://search.library.wisc.edu/">
              <img src="img/forward_laptop.png" alt="UW Forward: Laptop">
            </a>
          </section>

          <section>
            <h2 style="text-align:left;">UW Forward</h2>
            <ul style="float:right; width:58%;">
              <li>UW System Library Catalog</li>
              <li>9.5M+ Records
                <ul>
                  <li>MARC</li>
                  <li>MODS</li>
                  <li>Dublin Core</li>
                </ul>
              </li>
              <li>Colophon
                <ul>
                  <li>Ruby on Rails</li>
                  <li>Apache Solr</li>
                  <li>Blacklight</li>
                  <li>Bootstrap</li>
                </ul>
              </li>
            </ul>
            <img style="float:left" height="580" src="img/forward.png" alt="UW Forward"/>
          </section>

          <section>
            <img src="img/library_pic_umn.png" alt="Picture of a library."/>
          </section>

          <section>
            <h2 style="text-align:left;">
              UMN &middot; Web Arch. &amp; UX Analyst &middot; 2013+
            </h2>
            <a href="https://www.google.com/maps/place/O.+Meredith+Wilson+Library/@44.9709073,-93.2456804,17z/data=!3m1!4b1!4m5!3m4!1s0x52b32d41a338fe4b:0xf04cecd4029a51ad!8m2!3d44.9709073!4d-93.2434917">
              <img src="img/library_map_umn.png" alt="UMN - Wilson Library"/>
            </a>
          </section>

          <section>
            <h2>
              UMN Libraries
            </h2>
            <a href="http://www.lib.umn.edu/">
              <img src="img/umnlib_homepage.png" alt="U of MN Libraries - Homepage"/>
            </a>
          </section>

          <section>
            <h2>
              UMN Libraries
            </h2>
            <p>Web Development Dept.</p>
            <ul>
              <li>Cody Hanson - Manager</li>
              <li>Michael Berkowski</li>
              <li>Paul Bramscher</li>
          </section>

          <section>
            <h2>
              UMN Libraries
            </h2>
            <p>Web Development Dept.</p>
            <ul>
              <li>Hosting / Automation</li>
              <li>Performance Monitoring</li>
              <li>Penetration Testing</li>
              <li>Data Backups</li>
              <li>Disaster Recovery</li>
          </section>
        </section>

        <section data-background="#fafafa">
          <section>
            <h2>
              B1G Geoportal
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/geoportal.png" alt="B1G Geoportal - Homepage"/>
            </a>
          </section>

          <section>
            <h2>
              Development Path
            </h2>
            <ul>
              <li style="list-style:none;">
                <i class="fa fa-arrow-down"></i>
                Solr (Search/Datastore)
              </li>
              <li style="list-style:none;">
                <i class="fa fa-arrow-down"></i>
                Ruby on Rails (Web Framework)
              </li>
              <li style="list-style:none;">
                <i class="fa fa-arrow-down"></i>
                Blacklight (Discovery Layer)
              </li>
              <li style="list-style:none;">
                <i class="fa fa-arrow-down"></i>
                Geoblacklight (Geo Discovery Layer)
              </li>
              <li style="list-style:none;">
                <i class="fa fa-arrow-down"></i>
                Local Customizations (CSS, JS, HTML, Ruby)
              </li>
              <li style="list-style:none;">
                <i class="fa fa-thumbs-up"></i>
                B1G Geoportal
              </li>
            </ul>
          </section>

          <section>
            <h2>
              Solr > Blacklight
            </h2>
            <a href="https://github.com/projectblacklight/blacklight">
              <img src="img/blacklight_app.png" alt="B1G Geoportal - Blacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Solr > Blacklight
            </h2>
            <a href="https://github.com/projectblacklight/blacklight">
              <img src="img/blacklight_app_search.png" alt="B1G Geoportal - Blacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Solr > BL > GBL
            </h2>
            <a href="https://github.com/geoblacklight/geoblacklight">
              <img src="img/geoblacklight_app.png" alt="B1G Geoportal - Geoblacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Solr > BL > GBL
            </h2>
            <a href="https://github.com/geoblacklight/geoblacklight">
              <img src="img/geoblacklight_app_search.png" alt="B1G Geoportal - Blacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Solr > BL > GBL > B1G
            </h2>
            <a href="https://geo.btaa.org/">
              <img src="img/geoportal.png" alt="B1G Geoportal - Blacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Three Projects in One
            </h2>
            <a href="https://geo.btaa.org/">
              <img src="img/complexity.png" alt="B1G Geoportal - Three projects in one"/>
            </a>
          </section>

          <section>
            <h2>
              Balance
            </h2>
            <a href="https://github.com/BTAA-Geospatial-Data-Project/geoportal">
              <img src="img/challenge.png" alt="B1G Geoportal - Three projects in one"/>
            </a>
          </section>
        </section>

        <section>
          <section>
            <h2>
              <i class="fa fa-paint-brush"></i>
              Customizations
            </h2>
          </section>

          <section>
            <h2>
              Simple - Look &amp; Feel
            </h2>
            <a href="https://github.com/geoblacklight/geoblacklight">
              <img src="img/geoblacklight_app_search.png" alt="B1G Geoportal - Geoblacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Simple - Look &amp; Feel
            </h2>
            <h3>Design Goals</h3>
            <ul>
              <li>Follow BTAA branding guidelines</li>
              <li>Reusable styles for site and blog</li>
              <li>Ease of maintainablity</li>
            </ul>
          </section>

          <section>
            <h2>
              Simple - Look &amp; Feel - CSS
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/customization_css.png" alt="B1G Geoportal - CSS"/>
            </a>
          </section>

          <section>
            <h2>
              Simple - Look &amp; Feel - Results
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/geoportal_app_search_no_clusters.png" alt="B1G Geoportal - Blacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Moderate - Map Clusters
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/geoportal_map_clusters.png" alt="B1G Geoportal - Geoblacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Moderate - Map Clusters
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/geoportal_app_search.png" alt="B1G Geoportal - Geoblacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              Moderate - Map Clusters
            </h2>
            <h3>Design Goals</h3>
            <ul>
              <li>Help the map "speak"</li>
              <li>Make the map visually engaging</li>
              <li>Allow the map to inform
              <ul>
                <li>Collection strengths</li>
                <li>Highlight empty result areas</li>
              </ul></li>
            </ul>
          </section>

          <section>
            <h2>
              Moderate - Map Clusters
            </h2>
            <h3>Implementation</h3>
            <ul>
              <li>Add Leaflet Clustering Plugin (JS)</li>
              <li>Add Solr schema field (Solr)</li>
              <li>Initialize map with centroid data (JS)</li>
            </ul>
          </section>

          <section>
            <h3>
              Add Leaflet Clustering Plugin
            </h3>
            <a href="https://github.com/SINTEF-9012/PruneCluster">
              <img src="img/PruneCluster.png" alt="PruneCluster - Leaflet plugin"/>
            </a>
          </section>

          <section>
            <h3>
              Add Solr centroid schema field
            </h3>
            <a href="https://github.com/SINTEF-9012/PruneCluster">
              <img src="img/solr_admin_schema_change.png" alt="Solr - Schema analysis view"/>
            </a>
          </section>

          <section>
            <h3>Initialize map with centroid data</h3>
            <small>
              <a style="color:#FFF" href="https://github.com/BTAA-Geospatial-Data-Project/geoportal/blob/c9f7452dbf3c9af881bf055c857b075b12798c0b/app/assets/javascripts/geoblacklight/modules/results.js#L52-L69">
                /app/assets/javascript/geoblacklight/modules/results.js
              </a>
            </small>
            <pre><code class="javascript">
    // instantiate new map with PruneCluster
    geoblacklight = new GeoBlacklight.Viewer.Map(this, { bbox: bbox });
    var pruneCluster = new PruneClusterForLeaflet();

    // Oboe - Re-query Solr for JSON results
    var urlStr = window.location.href + '&format=json&per_page=1000&rows=10000';
    var urlStr = urlStr.replace(/page=[0-9]/,'');
    oboe(urlStr)
      .node('response.docs.*', function( doc ){
          if(typeof doc.centroid_s != 'undefined'){
            var latlng = doc.centroid_s.split(",")
            var marker = new PruneCluster.Marker(latlng[0],latlng[1], {popup: "<a href='/catalog/" + doc.uuid + "'>" + doc.dc_title_s + "</a>"});
            pruneCluster.RegisterMarker(marker);
          }
        }
      )
      .done(function(){
        geoblacklight.map.addLayer(pruneCluster);
      })
            </code></pre>
          </section>

          <section>
            <h2>
              Moderate - Map Clusters
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/geoportal_app_search.png" alt="B1G Geoportal - Geoblacklight UI"/>
            </a>
          </section>

          <section>
            <h2>
              <i class="fa fa-warning"></i>
              WAIT!
            </h2>
            <h3>Moderate - Map Clusters</h3>
            <ul>
              <li>Maintenance?</li>
              <li>Software tests?</li>
              <li>Geoblacklight upgrades?</li>
            </ul>
          </section>

          <section>
            <h3>Add some tests</h3>
<pre><code class="ruby">
  def test_map_clustering
    visit "/?q=water&amp;search_field=all_fields&amp;view=mapview"
    assert page.has_selector?("div.prunecluster.leaflet-marker-icon", :wait => 10)
  end

  def test_map_clustering_result_paging
    visit "/?page=2&amp;q=water&amp;search_field=all_fields&amp;view=mapview"
    assert page.has_selector?("div.prunecluster.leaflet-marker-icon", :wait => 10)
  end

</code></pre>
          </section>

          <section>
            <h3>Moderate - Map Clusters</h3>
            <ul>
              <li style="text-decoration:line-through; color:#333;">Maintenance?</li>
              <li style="text-decoration:line-through; color:#333;">Software tests?</li>
              <li>Geoblacklight upgrades?</li>
            </ul>
          </section>

          <section>
            <h2>
              <i class="fa fa-paint-brush"></i>
              Customizations
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/truck.png" alt="Truck"/>
            </a>
          </section>

          <section>
            <h2>
              <i class="fa fa-paint-brush"></i>
              Customizations - Um...
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/truck_flames.png" alt="Truck"/>
            </a>
          </section>

          <section>
            <h2>
              <i class="fa fa-paint-brush"></i>
              Customizations - OMG NO
            </h2>
            <a href="https://geo.btaa.org">
              <img src="img/truck_japanese_light.png" alt="Truck"/>
            </a>
          </section>
        </section>

        <section data-background="#2F3440">
          <section>
            <h2>
              <i class="fa fa-users"></i> Community
            </h2>
          </section>

          <section>
            <h2>
              B1G Geoportal Data Types
            </h2>
            <table>
              <tbody>
                <tr>
                  <td>Paper Map</td>
                  <td>2,485</td>
                  <td>30%</td>
                </tr>
                <tr>
                  <td>Mixed</td>
                  <td>1,985</td>
                  <td>24%</td>
                </tr>
                <tr>
                  <td>Polygon</td>
                  <td>1,668</td>
                  <td>20%</td>
                </tr>
                <tr>
                  <td>Point</td>
                  <td>1,377</td>
                  <td>16%</td>
                </tr>
                <tr>
                  <td>Line</td>
                  <td>631</td>
                  <td>8%</td>
                </tr>
                <tr>
                  <td>Raster</td>
                  <td>192</td>
                  <td>2%</td>
                </tr>
                <tr>
                  <td>Image</td>
                  <td>56</td>
                  <td>1%</td>
                </tr>
              </tbody>
            </table>
          </section>

          <section>
            <h2>Results > Paper Map</h2>
            <a href="https://geo.btaa.org">
              <img src="img/img_results_no_thumbs.png" alt="B1G Geoportal - Image at fold"/>
            </a>
          </section>

          <section data-background="img/img_mn_thumbs.png">
          </section>

          <section>
            <h2>Results > Paper map</h2>
            <a href="https://geo.btaa.org">
              <img src="img/img_results_no_thumbs.png" alt="B1G Geoportal - Image at fold"/>
            </a>
          </section>

          <section data-background="img/img_mn_thumbs.png">
            <h2 style="background-color:rgba(0,0,0,0.4); padding:1rem;">Uffda</h2>
          </section>

          <section>
            <h2>Show page > Paper map</h2>
            <a href="https://geo.btaa.org">
              <img src="img/img_fold.png" alt="B1G Geoportal - Image at fold"/>
            </a>
          </section>

          <section>
            <h2>What are other people doing?</h2>
          </section>

          <section>
            <h2>
              Stanford
            </h2>
            <a href="https://earthworks.stanford.edu/">
              <img src="img/geoblacklight_stanford.png" alt="Earthworks - Stanford"/>
            </a>
          </section>

          <section>
            <h2>
              NYU
            </h2>
            <a href="https://geo.nyu.edu/">
              <img src="img/geoblacklight_nyu.png" alt="Geoblacklight - NYU"/>
            </a>
          </section>

          <section>
            <h2>
              VecNet
            </h2>
            <a href="https://dl.vecnet.org/?q=&showmap=on">
              <img src="img/geoblacklight_vecnet.png" alt="Geoblacklight - VecNet"/>
            </a>
          </section>

          <section>
            <h2>
              Princeton
            </h2>
            <a href="https://github.com/pulibrary/pulmap/">
              <img src="img/geoblacklight_princeton.png" alt="Geoblacklight - Princeton"/>
            </a>
          </section>

          <section>
            <h2>
              Pulmap - GitHub
            </h2>
            <a href="https://github.com/pulibrary/pulmap/">
              <img src="img/pulmap_github.png" alt="Princeton - Github"/>
            </a>
          </section>

          <section>
            <h2>
              Pulmap - Eliot
            </h2>
            <a href="https://github.com/eliotjordan">
              <img src="img/eliotjordan.png" alt="Eliot Jordan - Github"/>
            </a>
          </section>

          <section>
            <h2>thumbnail.rb</h2>
            <pre><code class="ruby">
class Thumbnail
  def initialize(document)
    @document = document
  end

  ##
  # Get the thumbnail url from dctrefs if turned on in settings.
  # If not in dctrefs, then get it from a service endpoint (WMS, IIIF, etc...).
  # Return nil if both of those fail, so the thumbnail is not displayed.
  # @return [String, nil] thumbnail url
  def url
    if thumbnail_solr_field?
      thumbnail_solr_field
    elsif Settings.THUMBNAIL.USE_DCT_REFS
      thumbnail_reference || generated_thumbnail
    elsif restricted_scanned_map?
      thumbnail_reference
    else
      generated_thumbnail
    end
  end
            </code></pre>
          </section>

          <section>
            <h2>Dev > Results > Paper map</h2>
            <a href="https://geodev.btaa.org">
              <img src="img/img_results_thumbs.png" alt="B1G Geoportal"/>
            </a>
          </section>

          <section>
            <h2>Dev > Show page > Paper map</h2>
            <a href="https://geo.btaa.org">
              <img src="img/img_fold_dev.png" alt="B1G Geoportal - Image at fold"/>
            </a>
          </section>

        </section>

        <section data-background="#e6e6e6">
          <section>
            <h2><i class="fa fa-bar-chart"></i> Analytics</h2>
          </section>

          <section>
            <h2>
              What do we want to know?
            </h2>
          </section>

          <section>
            <h2>
              Web Traffic
            </h2>
            <small>
              <a href="https://datastudio.google.com/open/1OHXo0QgdtO-l8ncAKHBUp1dePKoTi5ip">Google Data Studio</a>
            </small>
            <iframe width="100%" height="750" src="https://datastudio.google.com/embed/reporting/1OHXo0QgdtO-l8ncAKHBUp1dePKoTi5ip/page/hvYK" frameborder="0" style="border:0" allowfullscreen></iframe>
          </section>

          <section>
            <h2>
              Feedback appreciated
            </h2>
          </section>
        </section>

				<section>
					<h1>THE END</h1>
					<p>
						<small><a style="color:#FFF;" href="mailto:ewlarson@umn.edu">Eric Larson</a>&nbsp; / &nbsp;<a style="color:#FFF;" href="http://twitter.com/ewlarson_umn">
							<i style="position:relative; top:-0.30em" class="fa icon-twitter"></i>
							@ewlarson_umn
						</a></small>
					</p>
				</section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
  </body>
</html>
